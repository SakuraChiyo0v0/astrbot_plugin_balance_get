# 更新日志

本项目的所有重要更改都将记录在此文件中。

## [v0.5.1] - 2026-01-30

### 🚀 新特性

- **平台支持**: 新增 ChatAnywhere 余额查询支持（`fetchers/chatanywhere.py`）。
- 感谢[@Arturia169](https://github.com/Arturia169)支持实现

## [v0.4.0] - 2026-01-12

### ♻️ 重构与优化

- **代码重构**: 提取了管理员权限检查逻辑 (`_is_admin`)，消除了重复代码。
- **性能优化**: 在 `BalanceManager` 中复用 `aiohttp.ClientSession`，减少了并发查询时的连接开销。
- **稳健性**: 增强了 API Key 获取逻辑，防止因异常导致流程中断。
- **逻辑简化**: 优化了 `BalanceResult.to_string` 的模板渲染逻辑，使其更清晰易读。
- **规范化**: 集中管理了模板默认值，并补充了缺失的类型提示。

## [v0.3.4] - 2026-01-09

### 💅 优化

- **模板逻辑优化**: `header_template` 不再包含分隔符，分隔符现在由代码自动插入。这使得修改 `separator_template` 时能统一影响所有位置，逻辑更清晰。

## [v0.3.3] - 2026-01-09

### 🚀 新特性

- **完全自定义模板**: 新增 `header_template` (标题) 和 `separator_template` (分隔符) 配置项，配合 `output_template`，实现对输出格式的完全自定义。

## [v0.3.2] - 2026-01-09

### 🚀 新特性

- **自定义模板**: 新增 `output_template` 配置项，允许用户自定义余额显示的格式。支持变量：`{{source_name}}`, `{{currency}}`, `{{balance}}` 等。

## [v0.3.1] - 2026-01-09

### 💅 优化

- **格式统一**: 统一了 `/当前余额查询` 和 `/所有余额查询` 的输出模板，使其风格一致。
- **信息精简**: 对于纯余额型账户（剩余余额=总余额），不再重复显示“总额”和“剩余”，只显示一行“余额”。

## [v0.3.0] - 2026-01-09

### 🚀 新特性

- **配置项**: 新增 `show_unsupported` 配置项（默认开启）。如果你不想看到未适配平台的列表，可以在配置中将其关闭，让界面更清爽。

## [v0.2.2] - 2026-01-09

### 💅 优化

- **ID 简化**: 未适配平台的展示现在会去除模型名称，只保留平台名称（例如 `zhipu/glm-4` -> `zhipu`），并自动去重，使输出更简洁。

## [v0.2.1] - 2026-01-09

### 💅 优化

- **结果去重**: `/所有余额查询` 现在会根据 API Key 和 Base URL 自动去重，避免同一平台显示多次。
- **样式美化**: 优化了 `/所有余额查询` 的输出格式，使其更加整洁美观。
- **未适配展示**: 在汇总信息的末尾列出未适配的平台名称（自动简化 ID，去除模型名），以便用户了解哪些平台无法查询。

## [v0.2.0] - 2026-01-09

### 🚀 新特性

- **新指令**: 添加 `/所有余额查询` 指令，支持并发查询所有已配置模型的余额。
- **并发查询**: 使用并行查询提高多模型查询时的性能。
- **结果分组**: 将查询结果按状态（成功、错误、不支持）分组展示，提升可读性。

## [v0.1.1] - 2026-01-09

### 🐛 修复

- **指令冲突**: 将指令从 `/balance` 重命名为 `/当前余额查询`，以避免与其他插件冲突。

## [v0.1.0] - 2026-01-09

### 🚀 新特性

- **初始版本**: 余额查询插件的第一个版本。
- **多厂商支持**:
  - DeepSeek (CNY)
  - Moonshot AI / Kimi (CNY)
  - SiliconCloud (USD)
- **自动识别**: 根据 `api_base` 自动识别当前 LLM 服务商。
- **权限控制**: 添加 `admin_only` 配置（默认：开启）。
- **安全性**: 日志中自动脱敏 API Key。
